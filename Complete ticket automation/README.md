# Ticket Automation with QR Code Generation

This project automates the process of generating QR codes for event tickets, generating unique Team IDs, and sending tickets via email using Google Apps Script. It is designed for use with Google Sheets and Google Drive.

---

## Folder Structure

```
/Complete ticket automation/
│
├── QRcode_genration.js
├── Team id genration according to game selected.js
├── Team id genration according to team size.js
├── Team id genration basic version from Birthdate.js
├── README.md
└── For HTML form of tickets/
    ├── QRcode_genration.js
    ├── Sending_tickets_with_QR_placing.js
    └── README.md
```

---

## Overview

The solution consists of several scripts for ticket automation:

### 1. Team ID Generation Scripts

- **Team id genration according to game selected.js**  
  Generates unique Team IDs based on the selected game.  
  *IDs are generated with a prefix and a game code suffix for easy identification.*

- **Team id genration according to team size.js**  
  Generates unique Team IDs based on the team size (e.g., SOLO, DUO, TRIO, QUAD).  
  *IDs include a suffix indicating the team size.*

- **Team id genration basic version from Birthdate.js**  
  Generates unique Team IDs of **exactly 10 characters** using a combination of a base prefix, the first character of the name, the last digit of the birthdate day, and two random alphanumeric characters.  
  *This ensures all IDs are compact, fixed-length, and unique.*

#### **ID Generation (10-character format) Example:**
- Structure: `[BASE][N][D][XX]`
  - `[BASE]` - Fixed prefix (e.g., `TX_25-`)
  - `[N]` - First character of the name
  - `[D]` - Last digit of the birthdate day
  - `[XX]` - Two random alphanumeric characters  
  *Example: `TX_25-J5A1`*

---

### 2. QR Code Generation

- **QRcode_genration.js**  
  Reads ticket data from a Google Sheet, generates a QR code for each ticket using the Team ID, and saves the QR code image to a Google Drive folder.  
  - Uses the [QuickChart API](https://quickchart.io/qr) to generate QR codes.
  - Saves QR code images as `{TeamID}.png` in the specified Google Drive folder.
  - If a QR code image already exists for a Team ID, it replaces the old image.

---

### 3. Ticket Email Automation

- **For HTML form of tickets/Sending_tickets_with_QR_placing.js**  
  Sends personalized emails to ticket holders with their ticket details and the corresponding QR code attached.
  - Loads an HTML email template (`ticket.html`), replaces placeholders with ticket data, and embeds the QR code image.
  - Marks the ticket as "Sent" in the sheet to avoid duplicate emails.
  - Sends a summary report to the admin email after all emails are sent.

---

## Setup

- Set your Google Sheet ID, sheet name, Google Drive folder ID, and admin email at the top of each script as required.
- For the HTML email script, ensure you have an HTML file named `ticket.html` in your Apps Script project with the required placeholders: `{Name}`, `{Time}`, `{Location}`, `{id}`, `{qr_image}`.

---

## Prerequisites

- A Google Sheet with ticket data (columns: Email, Name, ID, Location, Time, etc.).
- A Google Drive folder to store QR code images.
- Google Apps Script project linked to your Google account.
- An HTML email template file (`ticket.html`) for personalized ticket emails.

---

## Usage

1. **Generate Team IDs:**  
   - Run the appropriate ID generation script for your use case (by game, by team size, or by birthdate).
   - For the 10-character ID format, use `Team id genration basic version from Birthdate.js`.

2. **Generate QR Codes:**  
   - Run the `generateAndSaveQRCodes` function in `QRcode_genration.js`.

3. **Send Emails:**  
   - Run the `sendEmailsWithQR` function in `Sending_tickets_with_QR_placing.js`.

---

## Notes

- Update all placeholder values (`YOUR SHEET ID`, `SHEET NAME`, `FOLDER ID`, `ADMIN MAIL ID`) with your actual data.
- The QR code images are made accessible via a public link for embedding in emails.
- The script marks tickets as "Sent" to prevent duplicate emails.
- All Team IDs generated by the "basic version from Birthdate" script will be exactly 10 characters long for consistency and easy management.

---

## License

This project is for educational and internal event automation use.
Feel free to modify and use it as you see fit, but please do not redistribute or use for commercial purposes without permission.